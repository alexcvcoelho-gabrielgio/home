<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="238.7852px" preserveAspectRatio="none" style="width:1027px;height:238px;" version="1.1" viewBox="0 0 1027 238" width="1027.3319px" zoomAndPan="magnify"><defs><filter height="300%" id="f1o75asa9dj0rs" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.2212581344902387"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.442516268980477" dy="4.442516268980477" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="26.6551" x2="26.6551" y1="42.5336" y2="196.3905"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="323.7484" x2="323.7484" y1="42.5336" y2="196.3905"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="606.4035" x2="606.4035" y1="42.5336" y2="196.3905"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="743.5662" x2="743.5662" y1="42.5336" y2="196.3905"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="894.0564" x2="894.0564" y1="42.5336" y2="196.3905"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 5.0,5.0;" x1="985.128" x2="985.128" y1="42.5336" y2="196.3905"/><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="31.0976" x="8.885" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="15.5488" x="16.6594" y="25.539">UI</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="31.0976" x="8.885" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="15.5488" x="16.6594" y="217.487">UI</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="163.2625" x="240.4512" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="147.7137" x="248.2256" y="25.539">Session-Command</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="163.2625" x="240.4512" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="147.7137" x="248.2256" y="217.487">Session-Command</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="66.6377" x="570.8633" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="51.0889" x="578.6377" y="25.539">KAFKA</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="66.6377" x="570.8633" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="51.0889" x="578.6377" y="217.487">KAFKA</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="138.8286" x="672.4859" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="123.2798" x="680.2603" y="25.539">Session-Worker</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="138.8286" x="672.4859" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="123.2798" x="680.2603" y="217.487">Session-Worker</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="82.1866" x="850.7419" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="66.6377" x="858.5163" y="25.539">Datomic</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="82.1866" x="850.7419" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="66.6377" x="858.5163" y="217.487">Datomic</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="68.859" x="948.4772" y="3.3319"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="53.3102" x="956.2516" y="25.539">Mongo</text><rect fill="#FEFECE" filter="url(#f1o75asa9dj0rs)" height="33.6486" style="stroke: #A80036; stroke-width: 1.6659436008676791;" width="68.859" x="948.4772" y="195.2798"/><text fill="#000000" font-family="sans-serif" font-size="15.5488" lengthAdjust="spacingAndGlyphs" textLength="53.3102" x="956.2516" y="217.487">Mongo</text><line style="stroke: #000000; stroke-width: 1.1106290672451193; stroke-dasharray: 2.0,2.0;" x1="3.3319" x2="1027.3319" y1="54.7505" y2="54.7505"/><polygon fill="#A80036" points="310.9761,74.7419,322.0824,79.1844,310.9761,83.6269,315.4187,79.1844" style="stroke: #A80036; stroke-width: 1.1106290672451193;"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 2.0,2.0;" x1="26.6551" x2="317.6399" y1="79.1844" y2="79.1844"/><text fill="#000000" font-family="sans-serif" font-size="14.4382" lengthAdjust="spacingAndGlyphs" textLength="214.3514" x="34.4295" y="73.7055">GET /api/session/{session-id}</text><polygon fill="#A80036" points="971.8004,107.0976,982.9067,111.5401,971.8004,115.9826,976.243,111.5401" style="stroke: #A80036; stroke-width: 1.1106290672451193;"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 2.0,2.0;" x1="324.3037" x2="978.4642" y1="111.5401" y2="111.5401"/><text fill="#000000" font-family="sans-serif" font-size="14.4382" lengthAdjust="spacingAndGlyphs" textLength="165.4837" x="332.0781" y="106.0613">Busca pela informacao</text><polygon fill="#A80036" points="336.5206,139.4534,325.4143,143.8959,336.5206,148.3384,332.0781,143.8959" style="stroke: #A80036; stroke-width: 1.1106290672451193;"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 2.0,2.0;" x1="329.8568" x2="984.0174" y1="143.8959" y2="143.8959"/><text fill="#000000" font-family="sans-serif" font-size="14.4382" lengthAdjust="spacingAndGlyphs" textLength="154.3774" x="343.1844" y="138.417">Informação completa</text><polygon fill="#A80036" points="38.872,171.8091,27.7657,176.2516,38.872,180.6941,34.4295,176.2516" style="stroke: #A80036; stroke-width: 1.1106290672451193;"/><line style="stroke: #A80036; stroke-width: 1.1106290672451193; stroke-dasharray: 2.0,2.0;" x1="32.2082" x2="323.1931" y1="176.2516" y2="176.2516"/><text fill="#000000" font-family="sans-serif" font-size="14.4382" lengthAdjust="spacingAndGlyphs" textLength="236.564" x="45.5358" y="170.7728">Parse infomação para o usuarios</text><!--
@startuml
scale 1024*720
UI - -> "Session-Command": Envia mensagem de atulização
"Session-Command" - -> "Session-Command": Validações e regras de negocios
"Session-Command" - -> UI: Envia uma mensagem HTTP Ok (200)
"Session-Command" - -> KAFKA: Escreve a mensagem em uma lista
KAFKA - -> "Session-Worker": Envia comando
"Session-Worker" - -> Datomic: escreve historico
"Session-Worker" - -> Mongo: atualiza dado completo
newpage
UI - -> "Session-Command": GET /api/session/{session-id}
"Session-Command" - -> Mongo: Busca pela informacao
"Session-Command" <- - Mongo: Informação completa
"Session-Command" - -> UI: Parse infomação para o usuarios
@enduml

PlantUML version 1.2017.12(Wed Apr 26 13:06:36 BRT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_112-release-736-b16
Operating System: Linux
OS Version: 4.4.0-53-generic
Default Encoding: UTF-8
Language: pt
Country: BR
--></g></svg>